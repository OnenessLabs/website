(window.webpackJsonp=window.webpackJsonp||[]).push([[202],{1260:function(e,t,n){var i=n(5),a=n(323),o=Math.abs,r=Math.pow;i({target:"Math",stat:!0},{cbrt:function(e){var t=+e;return a(t)*r(o(t),1/3)}})},1261:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(80),a=n(79),v=(n(33),n(540),n(885),n(3),n(887),n(888),n(889),n(890),n(891),n(892),n(893),n(894),n(895),n(896),n(897),n(898),n(899),n(900),n(901),n(902),n(903),n(904),n(905),n(906),n(907),n(908),n(909),n(910),n(594)),o=Object(i.a)(function e(l,c,h){Object(a.a)(this,e),this.variables=[],this.currentTextureIndex=0;var r=v.n,s=new v.J,p=new v.e;p.position.z=1;var n={passThruTexture:{value:null}},u=t("uniform sampler2D passThruTexture;\n\nvoid main() {\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\n\tgl_FragColor = texture2D( passThruTexture, uv );\n\n}\n",n),d=new v.v(new v.D(2,2),u);function i(e){e.defines.resolution="vec2( "+l.toFixed(1)+", "+c.toFixed(1)+" )"}function t(e,t){t=t||{};var n=new v.K({uniforms:t,vertexShader:"void main()\t{\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:e});return i(n),n}s.add(d),this.setDataType=function(e){return r=e,this},this.addVariable=function(e,t,n){var i={name:e,initialValueTexture:n,material:this.createShaderMaterial(t),dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:v.x,magFilter:v.x};return this.variables.push(i),i},this.setVariableDependencies=function(e,t){e.dependencies=t},this.init=function(){if(!1===h.capabilities.isWebGL2&&!1===h.extensions.has("OES_texture_float"))return"No OES_texture_float support for float textures.";if(0===h.capabilities.maxVertexTextures)return"No support for vertex shader textures.";for(var e=0;e<this.variables.length;e++){var t=this.variables[e];t.renderTargets[0]=this.createRenderTarget(l,c,t.wrapS,t.wrapT,t.minFilter,t.magFilter),t.renderTargets[1]=this.createRenderTarget(l,c,t.wrapS,t.wrapT,t.minFilter,t.magFilter),this.renderTexture(t.initialValueTexture,t.renderTargets[0]),this.renderTexture(t.initialValueTexture,t.renderTargets[1]);var n=t.material,i=n.uniforms;if(null!==t.dependencies)for(var a=0;a<t.dependencies.length;a++){var o=t.dependencies[a];if(o.name!==t.name){for(var r=!1,s=0;s<this.variables.length;s++)if(o.name===this.variables[s].name){r=!0;break}if(!r)return"Variable dependency not found. Variable="+t.name+", dependency="+o.name}i[o.name]={value:null},n.fragmentShader="\nuniform sampler2D "+o.name+";\n"+n.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){for(var e=this.currentTextureIndex,t=0===this.currentTextureIndex?1:0,n=0,i=this.variables.length;n<i;n++){var a=this.variables[n];if(null!==a.dependencies)for(var o=a.material.uniforms,r=0,s=a.dependencies.length;r<s;r++){var l=a.dependencies[r];o[l.name].value=l.renderTargets[e].texture}this.doRenderTarget(a.material,a.renderTargets[t])}this.currentTextureIndex=t},this.getCurrentRenderTarget=function(e){return e.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(e){return e.renderTargets[0===this.currentTextureIndex?1:0]},this.dispose=function(){d.geometry.dispose(),d.material.dispose();for(var e=this.variables,t=0;t<e.length;t++){var n,i=e[t];null===(n=i.initialValueTexture)||void 0===n||n.dispose();for(var a=i.renderTargets,o=0;o<a.length;o++)a[o].dispose()}},this.addResolutionDefine=i,this.createShaderMaterial=t,this.createRenderTarget=function(e,t,n,i,a,o){return e=e||l,t=t||c,n=n||v.f,i=i||v.f,a=a||v.x,o=o||v.x,new v.Q(e,t,{wrapS:n,wrapT:i,minFilter:a,magFilter:o,format:v.G,type:r,depthBuffer:!1})},this.createTexture=function(){var e=new Float32Array(l*c*4),t=new v.j(e,l,c,v.G,v.n);return t.needsUpdate=!0,t},this.renderTexture=function(e,t){n.passThruTexture.value=e,this.doRenderTarget(u,t),n.passThruTexture.value=null},this.doRenderTarget=function(e,t){var n=h.getRenderTarget(),i=h.xr.enabled,a=h.shadowMap.autoUpdate,o=h.outputEncoding,r=h.toneMapping;h.xr.enabled=!1,h.shadowMap.autoUpdate=!1,h.outputEncoding=v.r,h.toneMapping=v.y,d.material=e,h.setRenderTarget(t),h.render(s,p),d.material=u,h.xr.enabled=i,h.shadowMap.autoUpdate=a,h.outputEncoding=o,h.toneMapping=r,h.setRenderTarget(n)}})},1262:function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n(880);var Y=n(79),i=n(80),f=n(884),r=n(978),a=n(881),o=n(883),s=n(806),Z=(n(943),n(33),n(27),n(162),n(32),n(3),n(594));function l(i){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=Object(s.a)(i);if(a){var n=Object(s.a)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Object(o.a)(this,e)}}var c=new Z.H,h=new Z.P,p=new Z.P,u=new Z.F,d={X:new Z.P(1,0,0),Y:new Z.P(0,1,0),Z:new Z.P(0,0,1)},g={type:"change"},v={type:"mouseDown"},m={type:"mouseUp",mode:null},w={type:"objectChange"},y=function(e){Object(a.a)(b,e);var y=l(b);function b(e,t){var n;Object(Y.a)(this,b),n=y.call(this),void 0===t&&(t=document),n.isTransformControls=!0,n.visible=!1,n.domElement=t,n.domElement.style.touchAction="none";var i=new O;n._gizmo=i,n.add(i);var a=new z;n._plane=a,n.add(a);var o=Object(f.a)(n);function r(t,e){var n=e;Object.defineProperty(o,t,{get:function(){return void 0!==n?n:e},set:function(e){n!==e&&(n=e,a[t]=e,i[t]=e,o.dispatchEvent({type:t+"-changed",value:e}),o.dispatchEvent(g))}}),o[t]=e,a[t]=e,i[t]=e}r("camera",e),r("object",void 0),r("enabled",!0),r("axis",null),r("mode","translate"),r("translationSnap",null),r("rotationSnap",null),r("scaleSnap",null),r("space","world"),r("size",1),r("dragging",!1),r("showX",!0),r("showY",!0),r("showZ",!0);var s=new Z.P,l=new Z.P,c=new Z.F,h=new Z.F,p=new Z.P,u=new Z.F,d=new Z.P,v=new Z.P,m=new Z.P,w=new Z.P;return r("worldPosition",s),r("worldPositionStart",l),r("worldQuaternion",c),r("worldQuaternionStart",h),r("cameraPosition",p),r("cameraQuaternion",u),r("pointStart",d),r("pointEnd",v),r("rotationAxis",m),r("rotationAngle",0),r("eye",w),n._offset=new Z.P,n._startNorm=new Z.P,n._endNorm=new Z.P,n._cameraScale=new Z.P,n._parentPosition=new Z.P,n._parentQuaternion=new Z.F,n._parentQuaternionInv=new Z.F,n._parentScale=new Z.P,n._worldScaleStart=new Z.P,n._worldQuaternionInv=new Z.F,n._worldScale=new Z.P,n._positionStart=new Z.P,n._quaternionStart=new Z.F,n._scaleStart=new Z.P,n._getPointer=function(e){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};var t=this.domElement.getBoundingClientRect();return{x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1,button:e.button}}.bind(Object(f.a)(n)),n._onPointerDown=function(e){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(e)),this.pointerDown(this._getPointer(e)))}.bind(Object(f.a)(n)),n._onPointerHover=function(e){if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(e))}}.bind(Object(f.a)(n)),n._onPointerMove=function(e){this.enabled&&this.pointerMove(this._getPointer(e))}.bind(Object(f.a)(n)),n._onPointerUp=function(e){this.enabled&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(e)))}.bind(Object(f.a)(n)),n.domElement.addEventListener("pointerdown",n._onPointerDown),n.domElement.addEventListener("pointermove",n._onPointerHover),n.domElement.addEventListener("pointerup",n._onPointerUp),n}return Object(i.a)(b,[{key:"updateMatrixWorld",value:function(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent||this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),Object(r.a)(Object(s.a)(b.prototype),"updateMatrixWorld",this).call(this,this)}},{key:"pointerHover",value:function(e){if(void 0!==this.object&&!0!==this.dragging){c.setFromCamera(e,this.camera);var t=x(this._gizmo.picker[this.mode],c);this.axis=t?t.object.name:null}}},{key:"pointerDown",value:function(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){c.setFromCamera(e,this.camera);var t=x(this._plane,c,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,v.mode=this.mode,this.dispatchEvent(v)}}},{key:"pointerMove",value:function(e){var t=this.axis,n=this.mode,i=this.object,a=this.space;if("scale"===n?a="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(a="world"),void 0!==i&&null!==t&&!1!==this.dragging&&-1===e.button){c.setFromCamera(e,this.camera);var o=x(this._plane,c,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===n)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===a&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===a&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),i.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===a&&(i.position.applyQuaternion(u.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.position.applyQuaternion(this._quaternionStart)),"world"===a&&(i.parent&&i.position.add(h.setFromMatrixPosition(i.parent.matrixWorld)),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.parent&&i.position.sub(h.setFromMatrixPosition(i.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){var r=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(r*=-1),p.set(r,r,r)}else h.copy(this.pointStart),p.copy(this.pointEnd),h.applyQuaternion(this._worldQuaternionInv),p.applyQuaternion(this._worldQuaternionInv),p.divide(h),-1===t.search("X")&&(p.x=1),-1===t.search("Y")&&(p.y=1),-1===t.search("Z")&&(p.z=1);i.scale.copy(this._scaleStart).multiply(p),this.scaleSnap&&(-1!==t.search("X")&&(i.scale.x=Math.round(i.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(i.scale.y=Math.round(i.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(i.scale.z=Math.round(i.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){this._offset.copy(this.pointEnd).sub(this.pointStart);var s=20/this.worldPosition.distanceTo(h.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(h.copy(this.rotationAxis).cross(this.eye))*s):"X"!==t&&"Y"!==t&&"Z"!==t||(this.rotationAxis.copy(d[t]),h.copy(d[t]),"local"===a&&h.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(h.cross(this.eye).normalize())*s),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===a&&"E"!==t&&"XYZE"!==t?(i.quaternion.copy(this._quaternionStart),i.quaternion.multiply(u.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),i.quaternion.copy(u.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),i.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(g),this.dispatchEvent(w)}}}},{key:"pointerUp",value:function(e){0===e.button&&(this.dragging&&null!==this.axis&&(m.mode=this.mode,this.dispatchEvent(m)),this.dragging=!1,this.axis=null)}},{key:"dispose",value:function(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}},{key:"attach",value:function(e){return this.object=e,this.visible=!0,this}},{key:"detach",value:function(){return this.object=void 0,this.visible=!1,this.axis=null,this}},{key:"reset",value:function(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(g),this.dispatchEvent(w),this.pointStart.copy(this.pointEnd))}},{key:"getRaycaster",value:function(){return c}},{key:"getMode",value:function(){return this.mode}},{key:"setMode",value:function(e){this.mode=e}},{key:"setTranslationSnap",value:function(e){this.translationSnap=e}},{key:"setRotationSnap",value:function(e){this.rotationSnap=e}},{key:"setScaleSnap",value:function(e){this.scaleSnap=e}},{key:"setSize",value:function(e){this.size=e}},{key:"setSpace",value:function(e){this.space=e}}]),b}(Z.z);function x(e,t,n){for(var i=t.intersectObject(e,!0),a=0;a<i.length;a++)if(i[a].object.visible||n)return i[a];return!1}var b=new Z.l,P=new Z.P(0,1,0),M=new Z.P(0,0,0),S=new Z.u,_=new Z.F,E=new Z.F,I=new Z.P,T=new Z.u,Q=new Z.P(1,0,0),A=new Z.P(0,1,0),k=new Z.P(0,0,1),X=new Z.P,j=new Z.P,F=new Z.P,O=function(e){Object(a.a)(j,e);var X=l(j);function j(){var e;Object(Y.a)(this,j),(e=X.call(this)).isTransformControlsGizmo=!0,e.type="TransformControlsGizmo";var t=new Z.w({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=new Z.q({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=t.clone();i.opacity=.15;var a=n.clone();a.opacity=.5;var o=t.clone();o.color.setHex(16711680);var r=t.clone();r.color.setHex(65280);var s=t.clone();s.color.setHex(255);var l=t.clone();l.color.setHex(16711680),l.opacity=.5;var c=t.clone();c.color.setHex(65280),c.opacity=.5;var h=t.clone();h.color.setHex(255),h.opacity=.5;var p=t.clone();p.opacity=.25;var u=t.clone();u.color.setHex(16776960),u.opacity=.25,t.clone().color.setHex(16776960);var d=t.clone();d.color.setHex(7895160);var v=new Z.i(0,.04,.1,12);v.translate(0,.05,0);var m=new Z.b(.08,.08,.08);m.translate(0,.04,0);var w=new Z.d;w.setAttribute("position",new Z.m([0,0,0,1,0,0],3));var y=new Z.i(.0075,.0075,.5,3);function b(e,t){var n=new Z.N(e,.0075,3,64,t*Math.PI*2);return n.rotateY(Math.PI/2),n.rotateX(Math.PI/2),n}y.translate(0,.25,0);var f,g={X:[[new Z.v(v,o),[.5,0,0],[0,0,-Math.PI/2]],[new Z.v(v,o),[-.5,0,0],[0,0,Math.PI/2]],[new Z.v(y,o),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new Z.v(v,r),[0,.5,0]],[new Z.v(v,r),[0,-.5,0],[Math.PI,0,0]],[new Z.v(y,r)]],Z:[[new Z.v(v,s),[0,0,.5],[Math.PI/2,0,0]],[new Z.v(v,s),[0,0,-.5],[-Math.PI/2,0,0]],[new Z.v(y,s),null,[Math.PI/2,0,0]]],XYZ:[[new Z.v(new Z.A(.1,0),p.clone()),[0,0,0]]],XY:[[new Z.v(new Z.b(.15,.15,.01),h.clone()),[.15,.15,0]]],YZ:[[new Z.v(new Z.b(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Z.v(new Z.b(.15,.15,.01),c.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},x={X:[[new Z.v(new Z.i(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new Z.v(new Z.i(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Z.v(new Z.i(.2,0,.6,4),i),[0,.3,0]],[new Z.v(new Z.i(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Z.v(new Z.i(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new Z.v(new Z.i(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new Z.v(new Z.A(.2,0),i)]],XY:[[new Z.v(new Z.b(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new Z.v(new Z.b(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Z.v(new Z.b(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},P={START:[[new Z.v(new Z.A(.01,2),a),null,null,null,"helper"]],END:[[new Z.v(new Z.A(.01,2),a),null,null,null,"helper"]],DELTA:[[new Z.p((f=new Z.d,f.setAttribute("position",new Z.m([0,0,0,1,1,1],3)),f),a),null,null,null,"helper"]],X:[[new Z.p(w,a.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Z.p(w,a.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Z.p(w,a.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},M={XYZE:[[new Z.v(b(.5,1),d),null,[0,Math.PI/2,0]]],X:[[new Z.v(b(.5,.5),o)]],Y:[[new Z.v(b(.5,.5),r),null,[0,0,-Math.PI/2]]],Z:[[new Z.v(b(.5,.5),s),null,[0,Math.PI/2,0]]],E:[[new Z.v(b(.75,1),u),null,[0,Math.PI/2,0]]]},S={AXIS:[[new Z.p(w,a.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},_={XYZE:[[new Z.v(new Z.M(.25,10,8),i)]],X:[[new Z.v(new Z.N(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Z.v(new Z.N(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Z.v(new Z.N(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Z.v(new Z.N(.75,.1,2,24),i)]]},E={X:[[new Z.v(m,o),[.5,0,0],[0,0,-Math.PI/2]],[new Z.v(y,o),[0,0,0],[0,0,-Math.PI/2]],[new Z.v(m,o),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new Z.v(m,r),[0,.5,0]],[new Z.v(y,r)],[new Z.v(m,r),[0,-.5,0],[0,0,Math.PI]]],Z:[[new Z.v(m,s),[0,0,.5],[Math.PI/2,0,0]],[new Z.v(y,s),[0,0,0],[Math.PI/2,0,0]],[new Z.v(m,s),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new Z.v(new Z.b(.15,.15,.01),h),[.15,.15,0]]],YZ:[[new Z.v(new Z.b(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Z.v(new Z.b(.15,.15,.01),c),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Z.v(new Z.b(.1,.1,.1),p.clone())]]},I={X:[[new Z.v(new Z.i(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new Z.v(new Z.i(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Z.v(new Z.i(.2,0,.6,4),i),[0,.3,0]],[new Z.v(new Z.i(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Z.v(new Z.i(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new Z.v(new Z.i(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new Z.v(new Z.b(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new Z.v(new Z.b(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Z.v(new Z.b(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Z.v(new Z.b(.2,.2,.2),i),[0,0,0]]]},T={X:[[new Z.p(w,a.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Z.p(w,a.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Z.p(w,a.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function Q(e){var t=new Z.z;for(var n in e)for(var i=e[n].length;i--;){var a=e[n][i][0].clone(),o=e[n][i][1],r=e[n][i][2],s=e[n][i][3],l=e[n][i][4];a.name=n,a.tag=l,o&&a.position.set(o[0],o[1],o[2]),r&&a.rotation.set(r[0],r[1],r[2]),s&&a.scale.set(s[0],s[1],s[2]),a.updateMatrix();var c=a.geometry.clone();c.applyMatrix4(a.matrix),a.geometry=c,a.renderOrder=1/0,a.position.set(0,0,0),a.rotation.set(0,0,0),a.scale.set(1,1,1),t.add(a)}return t}return e.gizmo={},e.picker={},e.helper={},e.add(e.gizmo.translate=Q(g)),e.add(e.gizmo.rotate=Q(M)),e.add(e.gizmo.scale=Q(E)),e.add(e.picker.translate=Q(x)),e.add(e.picker.rotate=Q(_)),e.add(e.picker.scale=Q(I)),e.add(e.helper.translate=Q(P)),e.add(e.helper.rotate=Q(S)),e.add(e.helper.scale=Q(T)),e.picker.translate.visible=!1,e.picker.rotate.visible=!1,e.picker.scale.visible=!1,e}return Object(i.a)(j,[{key:"updateMatrixWorld",value:function(e){var n=this,i="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:E;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;var a=[];a=(a=(a=a.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(var t=function(){var e,t=a[o];if(t.visible=!0,t.rotation.set(0,0,0),t.position.copy(n.worldPosition),e=n.camera.isOrthographicCamera?(n.camera.top-n.camera.bottom)/n.camera.zoom:n.worldPosition.distanceTo(n.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*n.camera.fov/360)/n.camera.zoom,7),t.scale.set(1,1,1).multiplyScalar(e*n.size/4),"helper"===t.tag)return t.visible=!1,"AXIS"===t.name?(t.position.copy(n.worldPositionStart),t.visible=!!n.axis,"X"===n.axis&&(u.setFromEuler(b.set(0,0,0)),t.quaternion.copy(i).multiply(u),.9<Math.abs(P.copy(Q).applyQuaternion(i).dot(n.eye))&&(t.visible=!1)),"Y"===n.axis&&(u.setFromEuler(b.set(0,0,Math.PI/2)),t.quaternion.copy(i).multiply(u),.9<Math.abs(P.copy(A).applyQuaternion(i).dot(n.eye))&&(t.visible=!1)),"Z"===n.axis&&(u.setFromEuler(b.set(0,Math.PI/2,0)),t.quaternion.copy(i).multiply(u),.9<Math.abs(P.copy(k).applyQuaternion(i).dot(n.eye))&&(t.visible=!1)),"XYZE"===n.axis&&(u.setFromEuler(b.set(0,Math.PI/2,0)),P.copy(n.rotationAxis),t.quaternion.setFromRotationMatrix(S.lookAt(M,P,A)),t.quaternion.multiply(u),t.visible=n.dragging),"E"===n.axis&&(t.visible=!1)):"START"===t.name?(t.position.copy(n.worldPositionStart),t.visible=n.dragging):"END"===t.name?(t.position.copy(n.worldPosition),t.visible=n.dragging):"DELTA"===t.name?(t.position.copy(n.worldPositionStart),t.quaternion.copy(n.worldQuaternionStart),h.set(1e-10,1e-10,1e-10).add(n.worldPositionStart).sub(n.worldPosition).multiplyScalar(-1),h.applyQuaternion(n.worldQuaternionStart.clone().invert()),t.scale.copy(h),t.visible=n.dragging):(t.quaternion.copy(i),n.dragging?t.position.copy(n.worldPositionStart):t.position.copy(n.worldPosition),n.axis&&(t.visible=-1!==n.axis.search(t.name))),"continue";if(t.quaternion.copy(i),"translate"===n.mode||"scale"===n.mode){"X"===t.name&&.99<Math.abs(P.copy(Q).applyQuaternion(i).dot(n.eye))&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),"Y"===t.name&&.99<Math.abs(P.copy(A).applyQuaternion(i).dot(n.eye))&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),"Z"===t.name&&.99<Math.abs(P.copy(k).applyQuaternion(i).dot(n.eye))&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),"XY"===t.name&&Math.abs(P.copy(k).applyQuaternion(i).dot(n.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),"YZ"===t.name&&Math.abs(P.copy(Q).applyQuaternion(i).dot(n.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),"XZ"===t.name&&Math.abs(P.copy(A).applyQuaternion(i).dot(n.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1)}else"rotate"===n.mode&&(_.copy(i),P.copy(n.eye).applyQuaternion(u.copy(i).invert()),-1!==t.name.search("E")&&t.quaternion.setFromRotationMatrix(S.lookAt(n.eye,M,A)),"X"===t.name&&(u.setFromAxisAngle(Q,Math.atan2(-P.y,P.z)),u.multiplyQuaternions(_,u),t.quaternion.copy(u)),"Y"===t.name&&(u.setFromAxisAngle(A,Math.atan2(P.x,P.z)),u.multiplyQuaternions(_,u),t.quaternion.copy(u)),"Z"===t.name&&(u.setFromAxisAngle(k,Math.atan2(P.y,P.x)),u.multiplyQuaternions(_,u),t.quaternion.copy(u)));t.visible=t.visible&&(-1===t.name.indexOf("X")||n.showX),t.visible=t.visible&&(-1===t.name.indexOf("Y")||n.showY),t.visible=t.visible&&(-1===t.name.indexOf("Z")||n.showZ),t.visible=t.visible&&(-1===t.name.indexOf("E")||n.showX&&n.showY&&n.showZ),t.material._color=t.material._color||t.material.color.clone(),t.material._opacity=t.material._opacity||t.material.opacity,t.material.color.copy(t.material._color),t.material.opacity=t.material._opacity,n.enabled&&n.axis&&(t.name===n.axis||n.axis.split("").some(function(e){return t.name===e}))&&(t.material.color.setHex(16776960),t.material.opacity=1)},o=0;o<a.length;o++)t();Object(r.a)(Object(s.a)(j.prototype),"updateMatrixWorld",this).call(this,e)}}]),j}(Z.z),z=function(e){Object(a.a)(n,e);var t=l(n);function n(){var e;return Object(Y.a)(this,n),(e=t.call(this,new Z.D(1e5,1e5,2,2),new Z.w({visible:!1,wireframe:!0,side:Z.k,transparent:!0,opacity:.1,toneMapped:!1}))).isTransformControlsPlane=!0,e.type="TransformControlsPlane",e}return Object(i.a)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),X.copy(Q).applyQuaternion("local"===t?this.worldQuaternion:E),j.copy(A).applyQuaternion("local"===t?this.worldQuaternion:E),F.copy(k).applyQuaternion("local"===t?this.worldQuaternion:E),P.copy(j),this.mode){case"translate":case"scale":switch(this.axis){case"X":P.copy(this.eye).cross(X),I.copy(X).cross(P);break;case"Y":P.copy(this.eye).cross(j),I.copy(j).cross(P);break;case"Z":P.copy(this.eye).cross(F),I.copy(F).cross(P);break;case"XY":I.copy(F);break;case"YZ":I.copy(X);break;case"XZ":P.copy(F),I.copy(j);break;case"XYZ":case"E":I.set(0,0,0)}break;default:I.set(0,0,0)}0===I.length()?this.quaternion.copy(this.cameraQuaternion):(T.lookAt(h.set(0,0,0),I,P),this.quaternion.setFromRotationMatrix(T)),Object(r.a)(Object(s.a)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(Z.v)}}]);